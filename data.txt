this is based on the c & c++ code